function ncalist = ncaregionsfromlatlon(latmatrix,lonmatrix)
%Uses inpolygon to find the NCA regions for a given matrix of latitude and longitude points (e.g. narrlats, narrlons)
%Output ncalist is already computed and saved in basicstuff.mat

%First, need to define the NCA-region polygons
%Alaska
alaskapolygonlats=[68.9;60.6;51.9;50.8;54.7;59.5;53.2;55;60;60.9;70.5;71.7;68.9];
alaskapolygonlons=[-167.2;-174;-178.9;-178.3;-155.5;-145.5;-134.1;-128.2;-135.1;-141;-141;-156;-167.2];
%Northwest
northwestpolygonlats=[48.6;42;42;44.5;44.755;44.575;44.442;45.699;45.51;46.667;...
    47.417;49;49;48.34;48.6];
northwestpolygonlons=[-125.5;-125;-111;-111;-111.39;-111.517;-112.956;-113.956;-114.38;-114.351;...
    -115.741;-116;-123.278;-123.35;-125.5];
%Southwest
southwestpolygonlats=[42;40.28;34;32.4;32.663;32.454;31.32;31.35;31.77;31.784;...
    31.895;32;32;37;37;41;41;42;42];
southwestpolygonlons=[-125;-125;-120.8;-117.5;-114.81;-114.84;-111.07;-108.23;-108.2;-106.578;...
    -106.642;-106.622;-103;-103;-102;-102;-111;-111;-125];
%Great Plains North
gpnpolygonlats=[49;47.42;46.66;45.514;45.7;44.44;44.575;44.755;44.504;41;...
    41;40;40;40.585;41.059;41.179;41.195;41.308;41.463;41.546;41.959;42.395;...
    42.459;42.495;42.627;42.724;43.13;43.28;43.485;43.504;45.302;45.626;45.921;...
    46.894;47.02;47.664;48.054;48.6;49;49];
gpnpolygonlons=[-116;-115.74;-114.35;-114.379;-113.96;-112.96;-111.517;-111.39;-111.06;-111;...
    -102;-102;-95.295;-95.754;-95.872;-95.865;-95.92;-95.908;-95.945;-96.078;-96.147;-96.411;...
    -96.38;-96.478;-96.52;-96.641;-96.441;-96.577;-96.593;-96.454;-96.454;-96.855;-96.57;...
    -96.746;-96.828;-96.872;-97.075;-97.13;-97.234;-116];
%Great Plains South
gpspolygonlats=[37;32;32;31.895;31.784;30.487;29.48;28.8;29.63;26.33;25.69;...
    25.93;27.53;29.6;30.89;32;33.56;33.64;35.45;36.55;38.959;39.12;39.15;39.218;...
    39.565;39.796;40;40;37;37];
gpspolygonlons=[-103;-103;-106.622;-106.642;-106.578;-105.227;-104.6;-103.23;-102;-99.21;-97.47;...
    -97;-97.12;-93.83;-93.56;-94;-94;-94.515;-94.45;-94.61;-94.609;-94.606;-94.593;-94.833;...
    -95.084;-94.903;-95.3;-102;-102;-103];
%Midwest
midwestpolygonlats=[40;40.585;41.059;41.179;41.195;41.308;41.463;41.546;41.959;42.395;...
    42.459;42.495;42.627;42.724;43.13;43.28;43.485;43.504;45.302;45.626;45.921;...
    46.894;47.02;47.664;48.054;48.6;49;49;49.44;49;48.39;46.6;45.34;...
    42.71;42.15;41.73;42.33;40.641;40.593;40.164;39.62;39.4;38.591;38.439;38.756;...
    38.655;39.051;39.119;39.096;39.094;39.128;38.833;38.741;38.281;38.286;38.02;...
    38.135;37.83;37.875;37.07;37.22;37;36.69;36.49;36;36;36.5;36.55;38.959;39.12;39.15;39.218;...
    39.565;39.796;40];
midwestpolygonlons=[-95.295;-95.754;-95.872;-95.865;-95.92;-95.908;-95.945;-96.078;-96.147;-96.411;...
    -96.38;-96.478;-96.52;-96.641;-96.441;-96.577;-96.593;-96.454;-96.454;-96.855;-96.57;...
    -96.746;-96.828;-96.872;-97.075;-97.13;-97.234;-95.186;-95.19;-94.724;-88.35;-84.1;-82.44;...
    -82.34;-83.05;-82.77;-80.52;-80.527;-80.662;-80.697;-80.879;-81.472;-82.194;-82.557;-82.895;...
    -83.68;-84.426;-84.466;-84.503;-84.559;-84.765;-84.867;-85.416;-85.732;-85.822;-86.04;...
    -86.306;-87.1;-87.89;-88.5;-88.97;-89.13;-89.17;-89.51;-89.71;-90.37;-90.16;-94.61;-94.61;-94.606;-94.593;-94.833;...
    -95.084;-94.903;-95.295];
%Southeast
southeastpolygonlats=[38.439;38.756;...
    38.655;39.051;39.119;39.096;39.094;39.128;38.833;38.741;38.281;38.286;38.02;...
    38.135;37.83;37.875;37.07;37.22;37;36.69;36.49;36;36;36.5;36.55;35.45;...
    33.64;33.56;32;30.89;29.6;28.9;28.9;30;29.5;29.8;27.57;25;24.47;24.47;...
    25.34;26.96;31.17;35.19;37.23;37.9;38.4;38.38;38.73;38.87;39.15;39.23;39.32;39.14;...
    39.47;38.43;38.59;37.44;37.19;37.5;38.15;38.439];
southeastpolygonlons=[-82.557;-82.895;...
    -83.68;-84.426;-84.466;-84.503;-84.559;-84.765;-84.867;-85.416;-85.732;-85.822;-86.04;...
    -86.306;-87.1;-87.89;-88.5;-88.97;-89.13;-89.17;-89.51;-89.71;-90.37;-90.16;-94.61;-94.45;...
    -94.515;-94.04;-94;-93.56;-93.83;-90.48;-89.1;-89.1;-85.2;-84;-82.9;-81.5;-82.24;-80.91;...
    -80.09;-79.79;-80.95;-75.23;-75.6;-76.3;-77;-77.29;-77.03;-77.03;-77.53;-77.46;-77.71;-77.82;...
    -78.34;-79.35;-79.67;-80.48;-81.69;-82.03;-82.62;-82.557];
%Northeast
northeastpolygonlats=[37.9;38.4;38.38;38.73;38.87;39.15;39.23;39.32;39.14;...
    39.47;38.43;38.59;37.44;37.19;37.5;38.15;38.439;38.59;39.4;39.62;40.16;40.59;...
    40.64;42.33;42.82;43.6;43.6;44.15;45;45;45.47;47.48;47.25;46;44.69;43.29;...
    42.28;42.03;41.19;40.48;39.73;38.94;38.04;37.9];
northeastpolygonlons=[-76.3;-77;-77.29;-77.03;-77.03;-77.53;-77.46;-77.71;-77.82;...
    -78.34;-79.35;-79.67;-80.48;-81.69;-82.03;-82.62;-82.557;-82.19;-81.47;-80.88;-80.7;-80.66;...
    -80.527;-80.52;-79.1;-79.3;-76.8;-76.5;-75.11;-71.83;-71;-69.25;-67.8;-67.8;-66.77;-70.37;...
    -70.51;-69.81;-69.77;-73.82;-73.97;-74.71;-75;-76.3];

%Now, determine the time zone for the inputted lat/lon list
for col=1:size(latmatrix,2)
    latlist=latmatrix(:,col);lonlist=lonmatrix(:,col);
    ptsinak(:,col)=inpolygon(latlist,lonlist,alaskapolygonlats,alaskapolygonlons);
    ptsinnw(:,col)=inpolygon(latlist,lonlist,northwestpolygonlats,northwestpolygonlons);
    ptsinsw(:,col)=inpolygon(latlist,lonlist,southwestpolygonlats,southwestpolygonlons);
    ptsingpn(:,col)=inpolygon(latlist,lonlist,gpnpolygonlats,gpnpolygonlons);
    ptsingps(:,col)=inpolygon(latlist,lonlist,gpspolygonlats,gpspolygonlons);
    ptsinmw(:,col)=inpolygon(latlist,lonlist,midwestpolygonlats,midwestpolygonlons);
    ptsinse(:,col)=inpolygon(latlist,lonlist,southeastpolygonlats,southeastpolygonlons);
    ptsinne(:,col)=inpolygon(latlist,lonlist,northeastpolygonlats,northeastpolygonlons);
end

ncalist=zeros(size(latmatrix,1),size(latmatrix,2));
ncalist(ptsinak==1)=1;
ncalist(ptsinnw==1)=2;
ncalist(ptsinsw==1)=3;
ncalist(ptsingpn==1)=4;
ncalist(ptsingps==1)=5;
ncalist(ptsinmw==1)=6;
ncalist(ptsinse==1)=7;
ncalist(ptsinne==1)=8;

end

